digraph CondorIntelligence {
    rankdir=TB;
    bgcolor="#0a0a0a";
    node [shape=box, style=filled, fontname="Helvetica", fontsize=10, color="white", fontcolor="black"];
    edge [color="white", fontcolor="white"];
    compound=true;
    fontcolor="white";

    subgraph cluster_input {
        label = "1. Data Inception (24 Parameters)";
        fontcolor="white";
        style = dashed;
        color = blue;
        input_spot [label="Spot Dynamics (5)\n(OHLCV)", fillcolor="#e1f5fe"];
        input_greeks [label="Option Physics (5)\n(Delta, Gamma, Vega, etc.)", fillcolor="#e1f5fe"];
        input_vol [label="Volatility (3)\n(IV, IVR, Spread)", fillcolor="#e1f5fe"];
        input_tech [label="Technicals (11)\n(RSI, ADX, BBands, PSAR)", fillcolor="#e1f5fe"];
    }

    subgraph cluster_preprocess {
        label = "2. Tactical Normalization";
        fontcolor="white";
        color = orange;
        norm [label="Z-Score (Med/MAD)\n+ Tanh Clipping (-10, 10)", fillcolor="#fff3e0"];
        gpu_unfold [label="GPU-Resident Unfold\n(O(1) Memory Views)", fillcolor="#fff3e0"];
    }

    subgraph cluster_backbone {
        label = "3. Neural CDE Architecture";
        fontcolor="white";
        color = purple;
        cde_encoder [label="Initial Encoder\nZ₀ = softplus(W·X₀)", fillcolor="#f3e5f5"];
        cde_vecfield [label="Vector Field f(Z)\nLinear→SiLU→Linear→Tanh", fillcolor="#f3e5f5"];
        cde_euler [label="Euler Integration\nZ_{t+1} = Z_t + f(Z_t)·dX_t", fillcolor="#f3e5f5"];
    }

    subgraph cluster_heads {
        label = "4. Multi-Channel Intelligence (23 Discrete Heads)";
        fontcolor="white";
        color = green;
        
        subgraph cluster_policy {
            label = "Policy Branch (8)";
            fontcolor="black";
            style = dotted;
            head_ic [label="Iron Condor Policy\nOffsets, Width, DTE, POP, ROI", fillcolor="#e8f5e9"];
        }
        
        subgraph cluster_regime {
            label = "Regime Experts (3)";
            fontcolor="black";
            style = dotted;
            head_moe [label="MoE Expert Mixing\n(Low, Normal, High Vol)", fillcolor="#e8f5e9"];
        }
        
        subgraph cluster_horizon {
            label = "Horizon Forecast (12)";
            fontcolor="black";
            style = dotted;
            head_price [label="1/3/5/10d Trajectory\n(Mean, Var, Direction)", fillcolor="#e8f5e9"];
        }
    }

    subgraph cluster_training {
        label = "5. Multi-Objective Learning";
        fontcolor="white";
        color = red;
        loss [label="CondorLoss (Lagrangian)\n(Huber + XEnt + MSE)", fillcolor="#ffebee"];
        val [label="Cross-Validation\n(No-Shuffle Temporal Split)", fillcolor="#ffebee"];
    }

    subgraph cluster_logic {
        label = "6. Neural-Fuzzy Decision Suite";
        fontcolor="white";
        color = navy;
        fuzzy [label="Fuzzy Engine\n(11 Membership Tiers)", fillcolor="#e8eaf6", fontcolor=black];
        money [label="Money Management\n(Risk-Weighted Sizing)", fillcolor="#3f51b5", fontcolor=white];
    }

    // Connections
    input_spot -> norm;
    input_greeks -> norm;
    input_vol -> norm;
    input_tech -> norm;
    
    norm -> gpu_unfold;
    gpu_unfold -> cde_encoder;
    cde_encoder -> cde_vecfield;
    cde_vecfield -> cde_euler;

    cde_euler -> head_ic [lhead=cluster_policy];
    cde_euler -> head_moe [lhead=cluster_regime];
    cde_euler -> head_price [lhead=cluster_horizon];
    
    head_ic -> loss;
    head_moe -> loss;
    head_price -> loss;
    
    loss -> val;
    val -> head_ic [label="Checkpoint Select", style=dashed];
    
    head_ic -> fuzzy [label="Signal Strength"];
    head_moe -> fuzzy [label="Volatility Context"];
    head_price -> fuzzy [label="Trajectory Validation"];
    
    fuzzy -> money;
    money -> "EXECUTION\n(Entry/Exit Signal)" [color=gold, penwidth=2];

    // Copyright Notice
    subgraph cluster_copyright {
        style=invis;
        rank=sink;
        node [shape=plaintext, fontsize=10, fontcolor="#777777", fontname="Helvetica"];
        copyright_note [label="© 2026 by Dr. T. Jerry Mahabub, Ph.D\nAll rights reserved."];
    }

}