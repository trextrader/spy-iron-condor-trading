digraph MembershipFunctions {
      rankdir=TB;
      bgcolor="#0a0a0a";
      fontname="Arial";
      fontsize=14;

      node [fontname="Arial", fontsize=11, style=filled];
      edge [fontname="Arial", fontsize=10];

      // Title
      title [label="Membership Function Curves\n(Domain → [0.0, 1.0] Mapping)",
             shape=box, fillcolor="#2c3e50", fontcolor=white, fontsize=16, style="filled,bold"];

      // RSI Function
      subgraph cluster_rsi {
          label="RSI Membership (μ_rsi)";
          style=filled;
          fillcolor="#ecf0f1";

          rsi_input [label="RSI Input\n(0-100)", shape=oval, fillcolor="#3498db", fontcolor=white];

          rsi_zone1 [label="RSI < 40\nμ = RSI / 40\nLinear decay", shape=box, fillcolor="#e74c3c", fontcolor=white];
          rsi_zone2 [label="40 ≤ RSI ≤ 60\nμ = 1.0\nPerfect zone", shape=box, fillcolor="#27ae60", fontcolor=white];
          rsi_zone3 [label="RSI > 60\nμ = (100-RSI) / 40\nLinear decay", shape=box, fillcolor="#e74c3c", fontcolor=white];

          rsi_output [label="μ_rsi ∈ [0.0, 1.0]", shape=oval, fillcolor="#9b59b6", fontcolor=white];

          rsi_input -> rsi_zone1 [label="if < 40"];
          rsi_input -> rsi_zone2 [label="if 40-60"];
          rsi_input -> rsi_zone3 [label="if > 60"];
          rsi_zone1 -> rsi_output;
          rsi_zone2 -> rsi_output;
          rsi_zone3 -> rsi_output;
      }

      // ADX Function
      subgraph cluster_adx {
          label="ADX Membership (μ_adx)";
          style=filled;
          fillcolor="#ecf0f1";

          adx_input [label="ADX Input\n(0-100)", shape=oval, fillcolor="#3498db", fontcolor=white];

          adx_zone1 [label="ADX ≤ 25\nμ = 1.0\nWeak trend (ideal)", shape=box, fillcolor="#27ae60", fontcolor=white];
          adx_zone2 [label="25 < ADX ≤ 40\nμ = 1 - (ADX-25)/15\nLinear decay", shape=box, fillcolor="#f39c12", fontcolor=white];
          adx_zone3 [label="ADX > 40\nμ = 0.0\nStrong trend (avoid)", shape=box, fillcolor="#e74c3c", fontcolor=white];

          adx_output [label="μ_adx ∈ [0.0, 1.0]", shape=oval, fillcolor="#9b59b6", fontcolor=white];

          adx_input -> adx_zone1 [label="if ≤ 25"];
          adx_input -> adx_zone2 [label="if 25-40"];
          adx_input -> adx_zone3 [label="if > 40"];
          adx_zone1 -> adx_output;
          adx_zone2 -> adx_output;
          adx_zone3 -> adx_output;
      }

      // Stochastic Function
      subgraph cluster_stoch {
          label="Stochastic Membership (μ_stoch)";
          style=filled;
          fillcolor="#ecf0f1";

          stoch_input [label="%K Input\n(0-100)", shape=oval, fillcolor="#3498db", fontcolor=white];

          stoch_zone1 [label="%K < 30\nμ = %K / 30\nOversold decay", shape=box, fillcolor="#e74c3c", fontcolor=white];
          stoch_zone2 [label="30 ≤ %K ≤ 70\nμ = 1.0\nNeutral zone", shape=box, fillcolor="#27ae60", fontcolor=white];
          stoch_zone3 [label="%K > 70\nμ = (100-%K) / 30\nOverbought decay", shape=box, fillcolor="#e74c3c", fontcolor=white];

          stoch_output [label="μ_stoch ∈ [0.0, 1.0]", shape=oval, fillcolor="#9b59b6", fontcolor=white];

          stoch_input -> stoch_zone1 [label="if < 30"];
          stoch_input -> stoch_zone2 [label="if 30-70"];
          stoch_input -> stoch_zone3 [label="if > 70"];
          stoch_zone1 -> stoch_output;
          stoch_zone2 -> stoch_output;
          stoch_zone3 -> stoch_output;
      }

      // Bollinger Bands Function
      subgraph cluster_bb {
          label="Bollinger Bands Membership (μ_bb)";
          style=filled;
          fillcolor="#ecf0f1";

          bb_pos_input [label="BB Position\n(0.0-1.0)", shape=oval, fillcolor="#3498db", fontcolor=white];
          bb_width_input [label="BB Width\n(% of mid)", shape=oval, fillcolor="#3498db", fontcolor=white];

          bb_pos_score [label="Position Score\nμ_pos = 1 - |pos - 0.5| × 2\nFavors middle", shape=box, fillcolor="#f39c12", fontcolor=white];
          bb_squeeze_score [label="Squeeze Score\nμ_squeeze = 1 - width/0.04\nFavors narrow", shape=box, fillcolor="#f39c12", fontcolor=white];

          bb_combine [label="Combined\nμ_bb = 0.7×μ_pos + 0.3×μ_squeeze", shape=box, fillcolor="#27ae60", fontcolor=white];

          bb_output [label="μ_bb ∈ [0.0, 1.0]", shape=oval, fillcolor="#9b59b6", fontcolor=white];

          bb_pos_input -> bb_pos_score;
          bb_width_input -> bb_squeeze_score;
          bb_pos_score -> bb_combine [label="70%"];
          bb_squeeze_score -> bb_combine [label="30%"];
          bb_combine -> bb_output;
      }

      // SMA Distance Function
      subgraph cluster_sma {
          label="SMA Distance Membership (μ_sma)";
          style=filled;
          fillcolor="#ecf0f1";

          sma_input [label="SMA Distance\n(% deviation)", shape=oval, fillcolor="#3498db", fontcolor=white];

          sma_zone1 [label="|dist| ≤ 2%\nμ = 1 - |dist|/0.02\nLinear decay from 1.0", shape=box, fillcolor="#27ae60", fontcolor=white];
          sma_zone2 [label="|dist| > 2%\nμ = 0.0\nToo far from equilibrium", shape=box, fillcolor="#e74c3c", fontcolor=white];

          sma_output [label="μ_sma ∈ [0.0, 1.0]", shape=oval, fillcolor="#9b59b6", fontcolor=white];

          sma_input -> sma_zone1 [label="if ≤ 2%"];
          sma_input -> sma_zone2 [label="if > 2%"];
          sma_zone1 -> sma_output;
          sma_zone2 -> sma_output;
      }

      // Volume Function
      subgraph cluster_vol {
          label="Volume Membership (μ_vol)";
          style=filled;
          fillcolor="#ecf0f1";

          vol_input [label="Volume Ratio\n(current / MA20)", shape=oval, fillcolor="#3498db", fontcolor=white];

          vol_calc [label="μ_vol = min(1.0, ratio / 0.8)\nLinear scale to 80% threshold\nCapped at 1.0", shape=box, fillcolor="#27ae60", fontcolor=white];

          vol_output [label="μ_vol ∈ [0.0, 1.0]", shape=oval, fillcolor="#9b59b6", fontcolor=white];

          vol_input -> vol_calc;
          vol_calc -> vol_output;
      }

      // Layout connections
      title -> rsi_input [style=invis];
      rsi_output -> adx_input [style=invis];
      adx_output -> stoch_input [style=invis];
      stoch_output -> bb_pos_input [style=invis];
      bb_output -> sma_input [style=invis];
      sma_output -> vol_input [style=invis];

      // Legend
      legend [label="Curve Characteristics:\n• Green = Favorable zones (μ → 1.0)\n• Red = Unfavorable zones (μ → 0.0)\n• Orange = Transition zones\n• All functions continuous and differentiable",
              shape=note, fillcolor="#ffffcc", fontsize=10];

      vol_output -> legend [style=invis];
  }
